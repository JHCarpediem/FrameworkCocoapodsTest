#include "DemoVehAutoAuthTest.h"
#include "DemoMaco.h"
#include "DemoPublicAPI.h"
#include <time.h>
#include "VehAutoAuth.h"

namespace Topdon_AD900_Demo {

	void CVehAutoAuthTest::ShowMenu()
	{
		vector<uint32_t> vctMenuID;

#if __Multi_System_Test__
		CArtiMenu uiMenu(m_uThread);
#else
		CArtiMenu uiMenu;
#endif
		uiMenu.InitTitle(artiGetText("FF0000000001"));
		uiMenu.AddItem("SFD API Test");		        vctMenuID.push_back(0);

		uint32_t uRetBtn = DF_ID_NOKEY;

		while (1)
		{
			uRetBtn = uiMenu.Show();
			if (DF_ID_BACK == uRetBtn)
			{
				break;
			}
			else if (uRetBtn < vctMenuID.size())
			{
				if (0 == vctMenuID[uRetBtn])
				{
					VehAutoAuthTest_SFDApiTest();
				}
			}
		}
	}

	void CVehAutoAuthTest::VehAutoAuthTest_SFDApiTest()
	{
		vector<int32_t> vctColWidth;
		vctColWidth.push_back(50);
		vctColWidth.push_back(50);

		vector<string> vctHeadNames;// = { "接口名称", "接口参数" };
		vctHeadNames.push_back(artiGetText("FF0C00000051"));
		vctHeadNames.push_back(artiGetText("FF0C00000052"));

#if __Multi_System_Test__
		CArtiList uiList(m_uThread);
#else
		CArtiList uiList;
#endif
		uiList.InitTitle(artiGetText("FF0C00000050"));// 大众 SFD 相关接口
		uiList.SetColWidth(vctColWidth);

		uiList.SetHeads(vctHeadNames);
		/*
		车辆识别码  :  LSVCD6F27P2025308
		车辆品牌    :  一汽奥迪
		车型        :  奥迪A7 L 2022>
		系统        :  19 - 数据总线诊断接口
		解锁请求信息:  65367334060D2B06010401990A8D110A02007153234258312D32343730342E31312E32333637353830363234000001220000018E50FD6004
		Token       :  7F218201D17F4E495F290170420D444555565747505346000001227F4C33060D2B06010401990A8D110A02000153224258312D32343730342E31312E323336373538303632340201010000018EE03D09925F37820180815D5DD0DCFE49B38B426AEFEF64C8927E2DBFBEB1E5A51FF727BA49F82876A005F946E3759FE1F1541F0920AF313BEF283408EB999152EE10D85E1C0184EE9E1DF349E6FC34CB6709CB55A0BAA01804A9776E18808CF31D83933C6A0AB2CA51659A8748C48B623092398959233563CF2492D4D6E349E471FF879F76F246CD6C22A03E89C71F97415430FBE6FFB673915D0F5C98C2E4417588FBDBC04F88763448E4C91EC40143F0D2C309B24921B97E8BB8B26110EBC2464BB29AC9314C7560D409BEAE0D686CD6495D61C37328A70463E4577AE001B5437EB4DAF9515A5841EDEB29A441A8104520F6C635097DE6A3BF34846CEA4C6FD1F7838E498BCB284A891BDB07AAACD34274DD155CA7F961333A80799378B37D2DC35E8DEF6B351947183406B3517027974F32F6C3B307C44EFCD3FF4E5457C8BDE3EFE4EC31F83B4126805F29790A6EE3A6FFDD05B7E8D1947E36F18DFB61296439610E8C30462777129024021ADA7FB676DC48CAFADFA63FFE651D9E28556CE43975C5D3608909CC
		*/

		string strVin = artiGetText("FF0C00000059");// "LSVCD6F27P2025308";
		string strVehBrand     = artiGetText("FF0C0000005A");//"一汽奥迪";
		string strVehModel     = artiGetText("FF0C0000005B");//"奥迪A7 L 2022>";
		string strSystemName   = artiGetText("FF0C0000005C");//"19 - 数据总线诊断接口";
		string strEcuChallenge = artiGetText("FF0C0000005D");//"65367334060D2B06010401990A8D110A02007153234258312D32343730342E31312E32333637353830363234000001220000018E50FD6004";
		string strEcuTocken    = artiGetText("FF0C0000005E");//"7F218201D17F4E495F290170420D444555565747505346000001227F4C33060D2B06010401990A8D110A02000153224258312D32343730342E31312E323336373538303632340201010000018EE03D09925F37820180815D5DD0DCFE49B38B426AEFEF64C8927E2DBFBEB1E5A51FF727BA49F82876A005F946E3759FE1F1541F0920AF313BEF283408EB999152EE10D85E1C0184EE9E1DF349E6FC34CB6709CB55A0BAA01804A9776E18808CF31D83933C6A0AB2CA51659A8748C48B623092398959233563CF2492D4D6E349E471FF879F76F246CD6C22A03E89C71F97415430FBE6FFB673915D0F5C98C2E4417588FBDBC04F88763448E4C91EC40143F0D2C309B24921B97E8BB8B26110EBC2464BB29AC9314C7560D409BEAE0D686CD6495D61C37328A70463E4577AE001B5437EB4DAF9515A5841EDEB29A441A8104520F6C635097DE6A3BF34846CEA4C6FD1F7838E498BCB284A891BDB07AAACD34274DD155CA7F961333A80799378B37D2DC35E8DEF6B351947183406B3517027974F32F6C3B307C44EFCD3FF4E5457C8BDE3EFE4EC31F83B4126805F29790A6EE3A6FFDD05B7E8D1947E36F18DFB61296439610E8C30462777129024021ADA7FB676DC48CAFADFA63FFE651D9E28556CE43975C5D3608909CC";

		uiList.AddItem("SetVin");			uiList.SetItem(0, 1, strVin);
		uiList.AddItem("SetVehBrand");		uiList.SetItem(1, 1, strVehBrand);
		uiList.AddItem("SetVehModel");		uiList.SetItem(2, 1, strVehModel);
		uiList.AddItem("SetSystemName");	uiList.SetItem(3, 1, strSystemName);
		uiList.AddItem("SetEcuChallenge");	uiList.SetItem(4, 1, strEcuChallenge);
		uiList.AddItem("SetEcuTocken");		uiList.SetItem(5, 1, strEcuTocken);

		uiList.AddButton("test");

		while (1)
		{
			uRetBtn = uiList.Show();
			if (uRetBtn == DF_ID_CANCEL)
			{
				break;
			}
			else if (uRetBtn == DF_ID_FREEBTN_0)
			{
#ifndef WIN32
				CVehAutoAuth vehAutoAuthTest;
				vehAutoAuthTest.SetVin(strVin);
				vehAutoAuthTest.SetVehBrand(strVehBrand);
				vehAutoAuthTest.SetVehModel(strVehModel);
				vehAutoAuthTest.SetSystemName(strSystemName);
				vehAutoAuthTest.SetEcuChallenge(strEcuChallenge);
				vehAutoAuthTest.SetEcuTocken(strEcuTocken);

				vehAutoAuthTest.SendRecv(CVehAutoAuth::eSendRecvType::SRT_VW_SFD_REPORT);
#endif


				artiShowMsgBox(artiGetText("FF0C00000050"), artiGetText("FF0C0000005F"));
			}
		}
	}

}